<div class="container py-4">
  <h2 class="mb-4 fw-bold">Tenant Management</h2>

  <!-- Form -->
  <div class="card shadow-sm mb-4">
    <form #TenantForm="ngForm" (ngSubmit)="editMode() ? updateTenant(TenantForm) : addTenant(TenantForm)">

      <div class="mb-3">
        <label class="form-label fw-semibold">
          <i class="bi bi-cash-coin text-primary me-1"></i> Property ID
        </label>
        <input type="number" class="form-control"
               [(ngModel)]="newTenant().PropertyID"
               name="PropertyID" #PropertyID="ngModel" required>
        <div *ngIf="PropertyID.invalid && PropertyID.touched" class="text-danger small">
          Property ID is required
        </div>
      </div>

      <!-- Name -->
      <div class="mb-3">
        <label class="form-label fw-semibold">
          <i class="bi bi-person-circle text-primary"></i> Name
        </label>
        <input type="text" class="form-control"
               [(ngModel)]="newTenant().Name"
               name="Name" #Name="ngModel" required>
        <div *ngIf="Name.invalid && Name.touched" class="text-danger small">
          Name is required
        </div>
      </div>

      <!-- Rental Payment Status -->
      <div class="mb-3">
        <label class="form-label fw-semibold">
          <i class="bi bi-wallet2 text-success"></i> Rental Payment Status
        </label>
        <select class="form-select"
                [(ngModel)]="newTenant().RentalPaymentStatus"
                name="RentalPaymentStatus" #RentalPaymentStatus="ngModel" required>
          <option value="" disabled selected>-- Select Status --</option>
          <option value="Paid">Paid</option>
          <option value="Pending">Pending</option>
        </select>
        <div *ngIf="RentalPaymentStatus.invalid && RentalPaymentStatus.touched" class="text-danger small">
          Rental payment status is required
        </div>
      </div>

      <!-- Lease Term Start -->
      <div class="mb-3">
        <label class="form-label fw-semibold">
          <i class="bi bi-calendar-event text-warning"></i> Lease Term Start
        </label>
        <input type="date" class="form-control"
               [min]="today"
               [(ngModel)]="newTenant().LeaseTermStart"
               name="LeaseTermStart" #LeaseTermStart="ngModel" required>
        @if(LeaseTermStart.invalid && LeaseTermStart.touched) {
          <div class="text-danger small">Start date is required</div>
        }
      </div>

      <!-- Lease Term End -->
      <div class="mb-3">
        <label class="form-label fw-semibold">
          <i class="bi bi-calendar-x text-danger"></i> Lease Term End
        </label>
        <input type="date" class="form-control"
               [min]="today"
               [(ngModel)]="newTenant().LeaseTermEnd"
               name="LeaseTermEnd" #LeaseTermEnd="ngModel" required>
        @if(LeaseTermEnd.invalid && LeaseTermEnd.touched) {
          <div class="text-danger small">End date is required</div>
        }
      </div>

      <!-- Contact Info -->
      <div class="mb-3">
        <label class="form-label fw-semibold">
          <i class="bi bi-telephone text-info"></i> Contact Info
        </label>
        <input type="text" class="form-control"
               [(ngModel)]="newTenant().ContactInfo"
               name="ContactInfo" #ContactInfo="ngModel" required>
        <div *ngIf="ContactInfo.invalid && ContactInfo.touched" class="text-danger small">
          Contact info is required
        </div>
      </div>

      <!-- Buttons -->
      <button type="submit" class="btn btn-primary btn-action me-2" [disabled]="TenantForm.invalid">
        <i class="bi" [ngClass]="editMode() ? 'bi-arrow-repeat' : 'bi-plus-circle'"></i>
        {{ editMode() ? 'Update Tenant' : 'Add Tenant' }}
      </button>
      <button type="button" class="btn btn-secondary btn-action" (click)="resetForm()" *ngIf="editMode()">
        <i class="bi bi-x-circle"></i> Cancel
      </button>
    </form>
  </div>

  <!-- Tenant List -->
  <div class="card shadow-sm">
    <div class="card-header">
      <h5 class="mb-0">Tenant List</h5>
    </div>
    <div class="table-responsive">
      <table class="table table-striped table-hover mb-0 align-middle">
        <thead>
          <tr>
            <th>Name</th>
            <th>Rental Status</th>
            <th>Lease Start</th>
            <th>Lease End</th>
            <th>Contact</th>
            <th class="text-end">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (tenant of tenants(); track tenant.TenantID) {
            <tr>
              <td>{{ tenant.Name }}</td>
              <td>
                <span class="badge"
                      [ngClass]="tenant.RentalPaymentStatus === 'Paid' ? 'bg-success' : 'bg-warning text-dark'">
                  {{ tenant.RentalPaymentStatus }}
                </span>
              </td>
              <td>{{ tenant.LeaseTermStart }}</td>
              <td>{{ tenant.LeaseTermEnd }}</td>
              <td>{{ tenant.ContactInfo }}</td>
              <td class="text-end">
                <button class="btn btn-sm btn-outline-primary me-2" (click)="editTenant(tenant)">
                  <i class="bi bi-pencil-square me-1"></i> Edit
                </button>
                <button class="btn btn-sm btn-outline-danger" (click)="confirmDelete(tenant.TenantID)">
                  <i class="bi bi-trash me-1"></i> Delete
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>
